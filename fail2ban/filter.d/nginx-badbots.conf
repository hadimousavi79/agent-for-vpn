[Definition]
failregex = ^<HOST> -.*"(GET|POST|HEAD|PUT|OPTIONS|DELETE|CONNECT).*HTTP.*"(?:Sogou web spider|Baiduspider|Googlebot|YandexBot|bingbot|rogerbot|MJ12bot|SemrushBot|AhrefsBot|BLEXBot|AspiegelBot|PetalBot|CPDLBot|Mythic\s+Beasts|\d\d\d\d\ Scanner|Barkrowler|BUbiNG|k2spider|Nutch|adscanner|Nmap Scripting Engine|ZmEu|masscan|zgrab|libwww-perl|python-requests|curl|wget|Wget|Go-http-client|[Ss]can|[Ss]canner|nikto|fierce|dirsearch|rusak|w3af|xenu|sqlmap|acunetix|nessus|netsparker|qualys|webinspect|grendel-scan|wpscan|WPScan|WhatWeb|wapiti|grabber|burp|openvas|joomscan|metasploit|masscan|inurlbr|useragent|seo|bot|crawler|webscan|webvulnscan|netcrawler|harvester|spider|spyder)
            ^<HOST> -.*"(GET|POST|HEAD|PUT|OPTIONS|DELETE|CONNECT).*HTTP.*"(?:[a-z0-9]{100,}|User-Agent: (?:Mozilla\/)?\d|User-Agent: \(|\\/\\%%\\$|\\x|eval\(|exec\(|system\(|passthru\(|shell_exec\(|UNION.*SELECT|INSERT.*INTO|SELECT.*FROM|DELETE.*FROM|UPDATE.*SET|<script>|javascript:|%%3Cscript%%3E|document\.cookie|onload=|onerror=|onclick=|alert\(|confirm\(|prompt\(|fromCharCode|encodeURI|document\.write|document\.location|window\.location|unescape\(|atob\(|btoa\(|String\.fromCharCode|fetch\(|XMLHttpRequest|ActiveXObject)
            ^<HOST> -.*"(GET|POST|HEAD|PUT|OPTIONS|DELETE|CONNECT).*(php|jsp|asp|cgi).*HTTP.*"(?:"|-|Mozilla\/[a-zA-Z0-9](\s|\+)|\(Windows|\(Linux|\(compatible|\(Java|\(PHP|\(Python|\(Ruby|\(Go|\(Perl|\(curl|\(PHP|Go\-http|\(compatible\;|\(iPhone|\(Android)

ignoreregex = ^.*(?:Ahrefs|SEMrush|MJ12bot|YandexBot|bingbot|Googlebot|DuckDuckBot|Baiduspider|Yahoo|facebookexternalhit|Chrome|Firefox|Safari|Edge|Opera|MSIE|Trident|Gecko).*$
             ^.*(\.jpg|\.jpeg|\.png|\.gif|\.ico|\.css|\.js|robots\.txt|favicon\.ico|sitemap\.xml)("|\\s|\\?|$) 