[Definition]
failregex = ^.*Failed password for .* from <HOST>(?: port \d+)?(?: ssh\d*)?(: (ruser .*|(\w+)))?\s*$
            ^.*Failed password for invalid user .* from <HOST>(?: port \d+)?(?: ssh\d*)?(: (ruser .*|(\w+)))?\s*$
            ^.*Failed publickey for .* from <HOST>(?: port \d+)?(?: ssh\d*)?(: (ruser .*|(\w+)))?\s*$
            ^.*Connection closed by authenticating user .* <HOST> port \d+ \[preauth\]\s*$
            ^.*Connection closed by invalid user .* <HOST> port \d+ \[preauth\]\s*$
            ^.*Disconnected from invalid user .* <HOST> port \d+.*\s*$
            ^.*Disconnected from authenticating user .* <HOST> port \d+.*\s*$
            ^.*maximum authentication attempts exceeded for .* from <HOST> port \d+.*\s*$
            ^.*Invalid user .* from <HOST>.*\s*$
            ^.*authentication failure; logname=\S* uid=\S* euid=\S* tty=\S* ruser=\S* rhost=<HOST>(?:\s+user=.*)?\s*$
            # DDOS protection patterns
            ^(?:Did not receive identification string from|Timeout before authentication for(?: connection from)?) <HOST>\s*$
            ^kex_exchange_identification: (?:read: )?(?:[Cc]lient sent invalid protocol identifier|[Cc]onnection (?:closed by remote host|reset by peer)) <HOST>\s*$
            ^Bad protocol version identification '(?:[^']|.*?)' (?:from )?<HOST>.*$
            ^no matching (?:cipher|mac|MAC|compression method|key exchange method|host key type) found(?:.*from )? <HOST>.*$
            # Botnet scanning patterns
            ^Received disconnect from <HOST>.*: 14: No supported authentication methods available.*$
            ^User not known to the underlying authentication module for .* from <HOST>\s*$
            ^Unable to negotiate with <HOST>.*: no matching (?:cipher|mac|MAC|compression method|key exchange method|host key type) found.*$
            # Real-time brute force protection
            ^maximum authentication attempts exceeded for (?:invalid user )?.*? from <HOST>.*$
            ^User .* from <HOST> not allowed because account is locked.*$
            ^Disconnecting: Too many authentication failures from <HOST>(?: for .*?)?.*$

ignoreregex = 